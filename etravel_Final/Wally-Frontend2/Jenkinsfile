pipeline {
    agent any

    environment {
        NODE_VERSION = '14.17.0' // Specify the exact Node.js version
    }

    stages {
        stage('Checkout') {
            steps {
                // Clone the repository from GitHub
                git 'https://github.com/anish-kapuskar/etravel_meanApp.git'
            }
        }

        stage('Install Node.js') {
            steps {
                // Download and install Node.js
                bat '''
                @echo off
                curl -o nodejs-installer.msi https://nodejs.org/dist/v%NODE_VERSION%/node-v%NODE_VERSION%-x64.msi
                msiexec /i nodejs-installer.msi /quiet /norestart
                if %ERRORLEVEL% neq 0 exit /b %ERRORLEVEL%
                '''

                // Ensure PATH is updated
                bat '''
                setx PATH "%ProgramFiles%\\nodejs;%PATH%"
                '''
            }
        }

        stage('Install Angular CLI and Dependencies') {
            steps {
                // Install Angular CLI globally and project dependencies
                bat '''
                @echo off
                set "NPM_GLOBAL=%APPDATA%\\npm"
                "%ProgramFiles%\\nodejs\\npm" install -g @angular/cli
                "%ProgramFiles%\\nodejs\\npm" install
                setx PATH "%NPM_GLOBAL%;%PATH%"
                '''
            }
        }

        stage('Build') {
            steps {
                // Build the AngularJS application
                bat 'ng build --prod'
            }
        }

     
